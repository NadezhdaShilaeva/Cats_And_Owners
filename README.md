# Cats And Owners
###### Проект по курсу технологии программирования

Данный проект реализует сервис по учету котиков и их владельцев. 
Позволяет пользователям вести учет своих домашних питомцев и их друзей - котиков.
Обеспечивает удобное хранение всех объектов, информации о них и связей между ними в базе данных.
Проект представляет собой единую систему, в которую объединены все хозяева и их питомцы и может быть полезен для любителей животных.

Существующая информация о ***котиках***:
- Имя
- Дата рождения
- Порода
- Цвет (один из заранее заданных вариантов: *WHITE, BLACK, GREY, RED*)
- Хозяин
- Список котиков, с которыми дружит этот котик (из представленных в базе)

Существующая информация о ***хозяевах***:
- Имя
- Дата рождения
- Список котиков

Проект реализован в трех вариантах, каждый из которых функуионирует независимо от других:
- HibernateService
- SpringBootRestfulService
- MicroserviceApplication

# HibernateService

Сервис реализует архитектуру **Service-Dao**.

Вся информация хранится в БД **PostgreSQL**. Для связи с БД используется **Hibernate**.

В качестве системы сборки проекта используется ***Gradle***.

Слой доступа к данным и сервисный слой являются двумя разными модулями Gradle. При этом проект полностью собирается одной командой.

Для тестирования логики сервисного слоя применен фреймворк ***[JUnit](https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter-api)***.

Также при тестировании использован ***[Mockito](https://mvnrepository.com/artifact/org.mockito/mockito-core)***, 
чтобы избежать подключения к реальным базам данных.


# SpringBootRestfulService

Сервис реализует архитектуру **Сontroller-Service-Dao**.

Созданный выше сервис переписан с использованием фреймворка ***SpringBoot***: 

- Сервисы и DAO должны пределаны в ***Spring Bean***’ы с использованием **Dependency Injection (Autowired)**.
- DAO при этом наследуют ***JpaRepository*** и имеют шаблонные Spring Data JPA методы.

Также реализован слой *Сontroller*:

- Сервис предоставляет HTTP интерфейс (**REST API**) для получения информации о конкретных котиках и владельцах и для
получения фильтрованной информации (например, получить всех рыжих котиков).
- Для передачи сущностей через HTTP интерфейс были созданы отдельные оберточные классы (***dto***).

И добавлена авторизация к сервису:

- Добавлена роль администратора. Он имеет доступ ко всем методам и может создавать новых пользователей. 
Пользователь связан с владельцем по правилу ***one-to-one***.
- Методы по получению информации и котиках и владельцах защищены ***Spring Security***. 
  - Доступ к соответсвующим endpoint’ам имеют только владельцы котиков и администраторы. 
  - Доступ к методам для фильтрации имеют все авторизованные пользователи, но на выходе получают только данные о своих котиках.

Для тестирования логики сервисного слоя также использованы фреймворки ***JUnit*** и ***Mockito***.

Работоспособность endpoint’ов протестирована вручную через HTTP запросы с помощью ***Postman***.

# MicroserviceApplication

Реализованная ранее (во второй версии) пограмма разбита на микросервисы.

Из созданного приложения выделены три микросервиса:
- Микросервис доступа к котикам (***catMicroservice***).
- Микросервис доступа к владельцам (***ownerMicroservice***).
- Микросервис с внешними интерфейсами (***externalMicroservice***).

Все они являются **разными приложениями**.

Общение между микросервисами происходит посредством ***[Kafka](https://kafka.apache.org/)***.

Все созданные ранее эндпоинты и авторизация перенесены третий микросервис.

Сервисы доступа к котикам и доступа к владельцам подключены к одной БД.

Для передачи JPA сущностей через Kafka созданы отдельные оберточные классы (***dto***).

Модуль с JPA сущностями выделен в отдельный подключаемый модуль ***commonDaoAndDto***.

Для тестирования логики сервисных слоев также использованы фреймворки ***JUnit*** и ***Mockito***.

Работоспособность endpoint’ов протестирована вручную через HTTP запросы с помощью ***Postman***.
